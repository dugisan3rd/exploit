# CVE-2022-44268: ImageMagick v7.1.0-49 Arbitrary File Read

## Description:
ImageMagick 7.1.0-49 is vulnerable to Information Disclosure. When it parses a PNG image (e.g., for resize), the resulting image could have embedded the content of an arbitrary. file (if the magick binary has permissions to read it).

## Usage:
```
python3 CVE-2022-44268_ImageMagick_Arbitrary_File_Read.py upload -p blue.png -r '/etc/hosts' -u 'http://pilgrimage.htb'
```

## PoC:
![poc](./poc.png)
Exploit tested on hackthebox machine, [Pilgrimage](https://app.hackthebox.com/machines/549).<br>
Writeup: https://dugisan3rd.notion.site/Pilgrimage-e4adcc0fe6344bdfad60ddff4b473f95?pvs=4

## References:
1. https://nvd.nist.gov/vuln/detail/CVE-2022-44268
2. https://www.metabaseq.com/imagemagick-zero-days/
3. https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC